/*
 * main.c
 *
 *  Created on: Mar 2, 2020
 *      Author: Youssef Harby & Mohamed Ramadan
 */


/*- INCLUDES -----------------------------------------------*/

#include "BCM.h"


/*- DEFINITIONS --------------------------------------------*/

#define OVERHEAD 		4
#define ELEMENTS(X)		(X + OVERHEAD)

#define UART_DONE		1
#define UART_NOT_DONE	0


volatile sint8_t SendingString[ELEMENTS(20)];

volatile uint8_t uart_counter = 0;

void Uart_SendingApp(void)
{
	uart_counter++;
	UART_receiveString((sint8_t*)ReceivedString);
}

int main(void)
{
	uint8_t UART_status = 0;
	UART_ConfigType UART_cfg = {
			UART_ASYNCHRONOUS_MODE,
			UART_SENDER_MODE,
			UART_INTERRUPT_ENABLED,
			UART_EIGHT_BITS,
			UART_PARITY_DISABLED,
			UART_ONE_STOP_BIT
	};

	strBcmConfig_t BCM_cfg = {
			BCM_SPI_ID,
			BCM_RECEIVE
	};

	strBcmSendConfig_t BCM_startCfg = {
			BCM_SPI_ID,
			(uint8_t*)SendingString,
			ELEMENTS(20)
	};


	BCM_Init(&BCM_cfg);

	UART_RXC_setCallBack(&Uart_SendingApp);

	UART_init(&UART_cfg);

	sei();

	while(1)
	{

	}
}



//uint8_t Buffer[ELEMENTS(21)];
//strBcmConfig_t cfg = {
//		BCM_SPI_ID,
//		BCM_RECEIVE
//};
//
//BCM_Init(&cfg);
//
//sei();
//
//BCM_SetupRxBuffer(BCM_SPI_ID, (uint8_t*)Buffer, sizeof(Buffer));
//
//while(1)
//{
//	BCM_RxDispatch();
//}
